---
title: "d-seperation 1"
format: html
editor: visual
---

# d-seperation

## Definition

Two variables are said to be d-separated if all paths between them are blocked (otherwise they are d-connected). Two sets of variables are said to be d-separated if each variable in the first set is d-separated from every variable in the second set.

##Rules: When is a path blocked?

1.  If there are no variables being conditioned on, a path is blocked if and only if two arrowheads on the path collide at somevariable on the path.
```{r dag 1}
library(ggdag)
dag_confound_ggdag <- dagify(
  Unfall ~ Drivingskills + Alkohol
)
# Plot the DAG
ggdag(dag_confound_ggdag, layout = "circle") + theme_dag_blank()


```

2.  Any path that contains a noncollider that has been conditioned on is blocked.
Example: We condition on stomach acidity
```{r}
library(ggdag)
dag3_confound_ggdag <- dagify(
c ~ b,
b ~ a,
coords = list(x = c(a = 1, b = 2, c = 3),
                y = c(a = 1, b = 1, c = 1))
)
# Plot the DAG
ggdag(dag3_confound_ggdag) + theme_dag_blank()
```
Beispiel:
B = Blutucker
M = Magensäure
H = Hunger

Der Blutzuckerspiegel beeinflusst die Übersäuerung im Magen, welche wiederum ein Hungergefühl verursacht.
Wenn wir den Pfad zwischen dem Blutzuckerspiegel und dem Hunger unter der Bedingung von einer Magenübersäuerung betrachten, ist dieser Pfad blockiert.
```{r}
library(ggdag)
dag2_confound_ggdag <- dagify(
  H ~ M,
  M ~ B,
   coords = list(x = c(B = 1, M = 2, H = 3),
                y = c(B = 1, M = 1, H = 1))
)
# Plot the DAG
ggdag(dag2_confound_ggdag) + theme_dag_blank()
```

3.  A collider that has been conditioned on does not block a path.
```{r}
library(ggdag)
dag_confound_ggdag <- dagify(
  Unfall ~ Drivingskills + Alkohol
)
# Plot the DAG
ggdag(dag_confound_ggdag) + theme_dag_blank()
  coords = list(x = c(Alkohol = 1, Unfall = 2, Drivingskills = 3),
                y = c(Alkohol = 1, Unfall = 2, Drivingskills = 1))

```

4.  A collider that has a descendant that has been conditioned on does not block a path.

## Example

If we measure the weather, the path between weather and sleep is blocked by the collider Mood (rule 1)

If we measure the weather, Mood and Outfit are conditionally independent, given weather (rule 2)

If we measure the Mood, the weather is conditionally independent of productivity, given Mood (rule 2)

Weather and sleep are d-connected, given Mood (rule 3)

If we condition on productivity, weather and sleep are also d-connected (rule 4)

```{r dag3}
library (dagitty)
dag3 <- dagitty("dag {
  Sleep -> Mood
  Weather -> Mood
  Mood ->Productivity
  Weather -> Outfit
 }")
plot( graphLayout( dag3 ) )
library(ggdag)
tidy_dag3 <- tidy_dagitty(dag3)
ggdag(tidy_dag3) +
  theme_dag()
```
